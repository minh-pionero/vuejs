import{u as $}from"./useStore-09c42126.js";import{d as x,i as D,j as b,r as u,o as n,c as f,w as y,a as s,f as S,t as V,h as m,E as O,b as v,F as R,e as F,v as N,x as T,_ as L,y as q,n as B}from"./index-057900fe.js";const j={class:"pa-4"},P={class:"float-right"},w=x({__name:"MediaRenameDialog",props:{isOpen:{type:Boolean,default:!1},title:{type:String,required:!1,default:""},onSubmit:{type:Function,required:!0},renameText:{type:String,required:!1,default:""}},emits:["onClose"],setup(t,{emit:e}){const l=t,o=$("media"),i=D(l.renameText),d=b(()=>o.getters(O.IS_SUBMITTING)),p=async()=>{await l.onSubmit(i.value),h()},h=()=>{e("onClose"),i.value=""};return(E,_)=>{const a=u("v-card-title"),c=u("VDivider"),r=u("VTextField"),I=u("v-btn"),k=u("v-card"),C=u("v-dialog");return n(),f(C,{"model-value":t.isOpen,width:"400",persistent:""},{default:y(()=>[s(k,null,{default:y(()=>[s(a,null,{default:y(()=>[S(V(t.title),1)]),_:1}),s(c),m("div",j,[s(r,{variant:"outlined",modelValue:i.value,"onUpdate:modelValue":_[0]||(_[0]=g=>i.value=g)},null,8,["modelValue"]),m("div",P,[s(I,{class:"mr-2",onClick:h,disabled:d.value},{default:y(()=>[S(" Cancel ")]),_:1},8,["disabled"]),s(I,{color:"blue",onClick:p,loading:d.value},{default:y(()=>[S(" Save ")]),_:1},8,["loading"])])])]),_:1})]),_:1},8,["model-value"])}}}),z=x({__name:"MediaItemAction",props:{activator:{type:String},mediaItem:{type:Object,required:!0}},setup(t){var E;const e=t,l=$("media"),o=[{title:"Open",type:"OPEN",disabled:!((E=e.mediaItem)!=null&&E.children)},{title:"Rename",type:"RENAME"},{title:"Delete",type:"DELETE"}],i=D(!1),d=_=>{var a,c;switch(_.type){case"OPEN":(a=e.mediaItem)!=null&&a.children&&l.dispatch(T.HANDLE_SELECT_DIRECTORY,e.mediaItem);break;case"RENAME":i.value=!0;break;case"DELETE":{const r={path:e.mediaItem.path,isFolder:(c=e.mediaItem)!=null&&c.children?1:0};l.dispatch(T.DELETE_FILE_OR_FOLDER,r);break}}},p=b(()=>{var c;if((c=e.mediaItem)!=null&&c.children)return{name:e.mediaItem.title};const _=e.mediaItem.title,a=_.lastIndexOf(".");if(a!==-1){const r=_.substring(0,a),I=_.substring(a+1);return{name:r,extension:I}}return null}),h=async _=>{var r;if(!_)return;const a=e.mediaItem.path,c=a.lastIndexOf("/");if(c!==-1){const I=a.substring(0,c),k={oldName:e.mediaItem.path,newName:`${I}/${_}${(r=p.value)!=null&&r.extension?`.${p.value.extension}`:""}`};if(k.oldName===k.newName)return;await l.dispatch(T.RENAME_FILE_OF_FOLDER,k)}};return(_,a)=>{var C;const c=u("v-list-item-title"),r=u("v-list-item"),I=u("v-list"),k=u("v-menu");return n(),v(R,null,[s(k,{transition:"slide-y-transition",activator:`#menu_${t.activator}`},{default:y(()=>[s(I,null,{default:y(()=>[(n(),v(R,null,F(o,(g,M)=>s(r,{key:M,value:M,onClick:()=>d(g),disabled:g==null?void 0:g.disabled},{default:y(()=>[s(c,null,{default:y(()=>[S(V(g.title),1)]),_:2},1024)]),_:2},1032,["value","onClick","disabled"])),64))]),_:1})]),_:1},8,["activator"]),i.value?(n(),f(w,{key:0,title:"Rename","rename-text":(C=p.value)==null?void 0:C.name,"is-open":i.value,"on-submit":h,onOnClose:a[0]||(a[0]=g=>i.value=!1)},null,8,["rename-text","is-open"])):N("",!0)],64)}}}),G=["id"],H={class:"text-center break-word"},U=x({__name:"MediaItem",props:{item:{type:Object,required:!0}},setup(t){return(e,l)=>{var d;const o=u("VIcon"),i=u("VImg");return n(),v(R,null,[m("div",{class:"w-100 ma-1 d-flex flex-column align-center cursor-pointer",id:`menu_${t.item.key}`},[m("div",null,[t.item.children?(n(),f(o,{key:0,icon:"mdi-folder",size:"75"})):(d=t.item)!=null&&d.isImage?(n(),f(i,{key:1,src:t.item.url,width:"75",height:"75"},null,8,["src"])):(n(),f(o,{key:2,icon:"mdi-file",size:"75"}))]),m("div",H,V(t.item.title),1)],8,G),s(z,{activator:t.item.key,"media-item":t.item},null,8,["activator","media-item"])],64)}}});const Y=L(U,[["__scopeId","data-v-0c97b7a6"]]),J={class:"border rounded-sm d-flex align-center"},K={class:""},Q={class:"pl-2 d-flex align-center"},W=x({__name:"MediaHeader",setup(t){const e=$("media");b(()=>e.getters(O.DIRECTORIES_REAL));const l=b(()=>{const i=[],d=e.getters(O.SELECTED_DIRECTORIES);return d?i.push(...d.path.split("/").map(p=>({title:p,disabled:!1}))):i.push({title:"uploads",disabled:!1}),i}),o=()=>{e.dispatch(T.HANDLE_SELECT_DIRECTORY)};return(i,d)=>{const p=u("VBtn"),h=u("VDivider"),E=u("v-breadcrumbs");return n(),v("div",J,[m("div",K,[s(p,{disabled:!l.value.length,rounded:"0",variant:"text",icon:"mdi-home-outline",onClick:o},null,8,["disabled"])]),s(h,{vertical:""}),m("div",Q,[s(E,{items:l.value,class:"py-1"},null,8,["items"])])])}}}),X={class:"text ml-1"},Z=x({__name:"TreeItem",props:{treeItem:{type:Object,required:!0},onClick:{type:Function,required:!1}},setup(t){const e=t,l=D(!1),o=()=>{var i,d;l.value=!l.value,(i=e.treeItem)!=null&&i.children&&((d=e.onClick)==null||d.call(e,e.treeItem))};return(i,d)=>{var h,E,_,a;const p=u("VIcon");return n(),v("li",null,[m("div",{onClick:o,class:"cursor-pointer d-flex item-center py-1"},[(h=t.treeItem)!=null&&h.children?(n(),v(R,{key:0},[l.value?(n(),f(p,{key:0,icon:"mdi-folder-open-outline"})):(n(),f(p,{key:1,icon:"mdi-folder-outline"}))],64)):(n(),f(p,{key:1,icon:"mdi-file-outline"})),m("span",X,V(t.treeItem.title),1)]),m("div",{class:q({hidden:!l.value})},[((_=(E=t.treeItem)==null?void 0:E.children)==null?void 0:_.length)>0?(n(),f(A,{key:0,items:((a=t.treeItem)==null?void 0:a.children)??[],"on-click-item":t.onClick},null,8,["items","on-click-item"])):N("",!0)],2)])}}});const ee=L(Z,[["__scopeId","data-v-6a58e909"]]),te={class:"ml-4 tree-list"},ne=x({__name:"TreeView",props:{items:{type:Array,required:!0},onClickItem:{type:Function,required:!1}},setup(t){return(e,l)=>(n(),v("div",null,[m("ul",te,[(n(!0),v(R,null,F(t.items,o=>(n(),f(ee,{key:o.key,"tree-item":o,"on-click":t.onClickItem},null,8,["tree-item","on-click"]))),128))])]))}});const A=L(ne,[["__scopeId","data-v-6936ef88"]]),ie={class:"wrapper"},ae=x({__name:"MediaSidebar",setup(t){const e=$("media"),l=b(()=>e.getters(O.DIRECTORIES_REAL)),o=i=>{e.dispatch(T.HANDLE_SELECT_DIRECTORY,i)};return(i,d)=>(n(),v("div",ie,[s(A,{items:l.value,"on-click-item":o},null,8,["items"])]))}});const se=L(ae,[["__scopeId","data-v-73e0dc47"]]),le={class:"d-flex justify-space-between mb-3"},oe=m("div",{class:"text-h5"},"Manage folders",-1),ce={key:0,class:"text-center my-16"},de={class:"d-flex flex-wrap"},re={key:0,class:"d-flex justify-center flex-fill py-4"},ue={class:"d-flex flex-column justify-center align-center"},_e=x({__name:"MediaLayout",setup(t){const e=$("media"),l=b(()=>e.getters(O.DIRECTORIES)),o=b(()=>e.getters(O.SELECTED_DIRECTORIES)),i=b(()=>e.getters(O.IS_LOADING)),d=D(!1),p=D(null);B(()=>{e.dispatch(T.GET_DIRECTORIES)});const h=async a=>{var r;const c={path:((r=o==null?void 0:o.value)==null?void 0:r.path)??"uploads",name:a};await e.dispatch(T.CREATE_FOLDER,c)},E=a=>{var r;const c={filePath:((r=o==null?void 0:o.value)==null?void 0:r.path)??"uploads",file:a.target.files[0]};e.dispatch(T.UPLOAD_FILE,c)},_=()=>{var a;(a=p.value)==null||a.click()};return(a,c)=>{const r=u("VIcon"),I=u("v-btn"),k=u("v-progress-circular");return n(),v(R,null,[m("div",le,[oe,m("div",null,[s(I,{title:"File upload",class:"mr-2",onClick:_},{default:y(()=>[s(r,{icon:"mdi-file-upload-outline"})]),_:1}),s(I,{title:"Create folder",onClick:c[0]||(c[0]=C=>d.value=!0)},{default:y(()=>[s(r,{icon:"mdi-folder-plus-outline"})]),_:1}),m("input",{hidden:"",type:"file",onChange:E,ref_key:"fileRef",ref:p},null,544)])]),i.value?(n(),v("div",ce,[s(k,{size:50,indeterminate:""})])):(n(),v(R,{key:1},[s(W),m("div",de,[s(se),l.value.length?(n(!0),v(R,{key:1},F(l.value,C=>(n(),f(Y,{key:C.key,item:C},null,8,["item"]))),128)):(n(),v("div",re,[m("div",ue,[s(r,{icon:"mdi-folder-outline",size:"50"}),S(" Folder is empty ")])]))])],64)),s(w,{title:"Create folder","is-open":d.value,"on-submit":h,onOnClose:c[1]||(c[1]=C=>d.value=!1)},null,8,["is-open"])],64)}}}),ve=x({__name:"MediaPage",setup(t){return(e,l)=>(n(),f(_e))}});export{ve as default};
